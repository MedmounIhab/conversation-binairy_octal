#include <math.h>
#include <stdio.h>
#include <stdlib.h>

int nombre_bin_entier,chiffre;


/*procedure qui test si un nombre est binaire ou non*/
void binaire(double *p) {
  double nombre_bin_flottant;
  int indicateur_bin=1,indicateur_flottant=1,i,tmp,c=0;
  do{
    indicateur_flottant=1;
    nombre_bin_entier=*p;
    nombre_bin_flottant= *p - nombre_bin_entier;
    if ( nombre_bin_flottant == 0 )
    {
        indicateur_flottant=1;
    }
    else
    {
            for ( i = c ; i < 10 ; i++ )
            {
                nombre_bin_flottant*=10;
                tmp= nombre_bin_flottant;
                tmp= tmp % 10;
                printf("%d ",tmp);
                if ( tmp != 1 && tmp != 0 )
                    {
                        indicateur_flottant=0;
                        printf("\nce nombre est pas binaire");
                        printf("\n-------------------------------------\nsaisissez un nombre "
                        "en binaire : ");
                        scanf("%lf", p);
                        nombre_bin_entier = *p;
                        nombre_bin_entier=*p;
                        nombre_bin_flottant= *p - nombre_bin_entier;
                        c=0;
                    }
                    else if ( nombre_bin_flottant == 0 )
                    {
                        indicateur_flottant=1;
                        c=6;
                    }
                    else
                    {
                        indicateur_flottant=1;
                    }
            }
    }
    if ( indicateur_flottant == 1 )
    {
    while ( nombre_bin_entier != 0 ) {
      chiffre = nombre_bin_entier % 10;
      if (chiffre != 1 && chiffre != 0) {
        indicateur_bin = 0;
        nombre_bin_entier = 0;
        printf("\nce nombre est pas binaire");
        printf("\n-------------------------------------\nsaisissez un nombre "
               "en binaire : ");
        scanf("%lf", p);
        nombre_bin_entier=*p;
      } else {
        indicateur_bin = 1;
        nombre_bin_entier /= 10;
      }
    }
    }
  } while (indicateur_bin == 0 && indicateur_flottant == 0 );
}


/*lfonction qui converte le nombre on octale*/
int nombre_octale_bin(double *p)
{
  double octale=0;
  int i,n=0,s=0,c=3;
  nombre_bin_entier=*p;
  while (nombre_bin_entier != 0) {
    for ( i = c ; i >= 1 ; i-- ) {
      if (nombre_bin_entier == 0) {
        break;
      }
      chiffre= nombre_bin_entier % 10;
      octale= octale +  pow ( 2 , n ) * chiffre;
      nombre_bin_entier /= 10;
      n++;
    }
    c = 3;
    n = 0;
    s = s * 10 + octale;
    octale = 0;
  }
  while (s != 0) {
    chiffre = s % 10;
    octale= octale * 10 + chiffre;
    s/= 10;
  }
  return octale;
}


int main() {
  double nombre_bin,octale;
  printf("\n-------------------------------------\nsaisissez un nombre en binaire : ");
  scanf("%lf", &nombre_bin);
  binaire(&nombre_bin);
  octale= nombre_octale_bin(&nombre_bin);
  printf("\nle nombre en octale est : %.lf",octale);
  return 0;
}
